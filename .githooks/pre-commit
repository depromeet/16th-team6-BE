
#!/usr/bin/env bash

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
RED_BOLD='\033[1;31m'
GREEN_BOLD='\033[1;32m'
RESET='\033[0m'

cd "$SCRIPT_DIR" && cd ../

echo "DETEKT 검사를 진행하고 있습니다..."
OUTPUT="/tmp/detekt-$(date +%s)"

./gradlew detekt > $OUTPUT
EXIT_CODE=$?

if [ $EXIT_CODE -ne 0 ]; then
  cat $OUTPUT
  rm $OUTPUT
  echo -e "${RED_BOLD}"
  echo "        ..  ................. ...             ........ ....................  .. .....
                ..  ...........:--.......             ............................................  ...
                ..   ...:#%##@#+=-.......             ..........:::---==+++++--....................  ..
                ..  ....##:.=@=.............   .. .. .......=++=-:::..........:=+=---::::::::....................... ... .
              ..........%*..=@=.............    .........-*+:.....................::::::::----++++=:.......................
              ..........:*#%%@%##*+:........   ........:+=............  ...........................:-+*#**##*##*#+-........
                     .. ..... ..............    .... .=*:.............      .... ... ....... .. .....  ....... ...=%:.....
                    ...=#%%%%%%@@%%#=.......   .....:+=...........::.......       ............... ............ ....+#......
                    ......*#:.:**.........     ....:*=.........:=*=:.......       ................................-#-.....
                    .....:#%+:-#+... ....      ....-#=----=+*#+=--=-.......       ............=*:....... ........-*:.......
                    .....:*#:.+%+....        .........::::.-+:*%+#%+:.......      ......=*+-:..**:.............:*#-.......
                    ...........:.........       ..........-#-:#@@##=........   ........+@*-*@@#=+#:..........:**-+=........
               ...........................     .....:---.=%*---+:...........    .......-%@%%**@#:=@+.......-*+:..=*:......
               ........ -%#*@*::=+*%@=......   .........=+..--....:::.......     .......:===:..:..:##::-+#*-.....-%=.......
               ........+@=...+%=.:.*%-.................:+=...-##=-::........      ..........-:.:.....:::..........+%......
                 ......:%#==+#*:...*%-.........:::::...:+-......:--:........      ..........-:.:......  ..........-%:......
                  ........--:....:-*%-.......:=:..--...=+:......+%%%+.......           ....:-..:.......  .........:*=......
                    ..............-+=..........::::....++......................... ..  ....-:....... ..     ......:*=......
                    ........::.........................-=....:+#+=+**=-:..........     ....-:..:......     ........+*......
               ..........+#+*#%%%**%%=............. ...-=:.....*#:...::::=#*-.....     ....:-.::.......      . ....=#......
               .........##:....*#:.*#-.....         ...:+=......#+.......+*:.....      .... .--......     .... ....*+.....
               .........-%#=+##=..:#*:......    ........-#-.....*+:.....:**:......     ................   .......:++.......
                    .......::....-#@=......           ...:*+:...=#-.....:**:......    ........:-:......   ......=*-........
                     ......................           .....:*=...**:.....+#:......     .....:-:-:...... ........:-=........
             ..............................           ......=#:..=*-.....-%=......     ...........................=*.......
                    ....:+#*%%%####%+......           .......+*..:*=.....:#*.......    ............................-#-....
                    ...:@+...:*#-.-%+......           .......=%:..=*:....:#*..........................-*=...........:%=...........
                 .......#%=::=##-.+%=......           ........-=..:--....-%=......................=*#+:...............*+........
                  ........:==:....*@-......           ... .....=%=:+%=...:*#:.............:-=+*#*=............ ........+#:......
                    ..............+*:......              .   ....-+*##%##*-:....:::-=+***+=::...::.................. ...=#-.... ..
                    .......................                  ...........-=++++++==-:........................... .........-#=........
                    .......................                   ...........=#:......... ................-+=:...  .... ......:++:........
                    .....:***#%%%###%+.....                  ............+%=.............. ........:++-.......      . ......=*-........
                    .....*%:..:#*..:#+.....                  ... ........=%+..... . .. ...........+#:.........       . ......=*:.......
                     ....:*%#%#+...-%+......                      ........*%:....      ..........**...........         ......:++......
                     ..............-#+.....                       ........:#=.....     ....::--:++.....               ........:*-.....
                    ... ............*#-........                   .........=+:...      ........-#-.....             .........:+%-........
                    ... .......................                     .......:#=.................=#-.....       ..............-*++*=:...... ...
                    ........+*+----=*%#-........                    ........+=.................-#=.....      .. ...........-#+::.:=*+-:......
                    ......=%+:-#%+=-:*#-....                        ........+=....-=:.....+*:...=#-.....    ............-+#@@#=*%+:.:-*#-......
                    ......-%#=*#=...:#*:........                    ........=+:...+@=.....+*:....-%+..............:-*#@@@@@@@@@@@@@@@#-.... ...
                     .......:::.....:#*:....  ..             ..    .........:*-..:#@+....=%@@@@@%*=:..........=#@@@@@@@@@@@@@@@@@@@@@@=...... ..
                       .............=%*:....   .                  ...........-*+*@@@@%##@@@@@@@*--::::-=+#%@@@@@@@@@@@@@@@@@@@@@@%*-.......  ...
                           .................                     .........:=#%@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#*+-...........     ..
                    ...       ..............                     ......:*@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@%%%%%###**+==-:.................
                                  .......                        ........:-=++++++=====-------:::.................................
                                                                  .............................................. ..........
                                                                     ............ .... ... ................... .....
                                                                        ..... .. . ..          .. ..    .  ... . ...
                                                                                                                                                "
  echo ""
  echo "*****************************************************************"
  echo "                  DETEKT 검사에 걸려벼렸스요                          "
  echo "             위 이슈를 모두 고친 후 다시 커밋하십시오                      "
  echo "*****************************************************************"
  echo -e "${RESET}"
  exit $EXIT_CODE
else
  echo -e "${GREEN_BOLD}"
  echo "
                                                  @@@@@@@
                                               @@%*-:::+@@@
                                              @@-.     .-@@
                                            @@+..      ..*@@                                          @@@@@@@@@@@
                                           @@-.        ..-%@                                        @@*-.......=@@
                                          @@+.         ..:%@@                                    @@#-....   ....#@@
                                          @%:.         ...#@@ @@@@@@@@@@@@@@@@@@@@@@@@          @@=.        ....%@@
                                          @%:.         ...=@@%*=:................:-=+#%@@@@@  @@+...        ...=@@
                                          @@=..        ............                 .....-+#@@@=....        ..-%@
                                           @@+....     ...........                  ..........:.....    .....+@@
                                            @@%-...                                                     ...-%@
                                              @@#:.                                           ......... .+%@@
                                  .+%-         @@+.                                           ....:+=-=#@@
                          .....   .=@+=*%=.    @@*.    ....-####=......        .... ...-==-:......#@@@@
                       .-#%+++=%+..-@+-:..    @@@=.    ...*@@@@@@%-....        ......#@@@@@@@+....-@@@
                      .:%@-...=%- .:+.        @@:..    ...-%@@@@@+.....        ......=@@@@@@@+.....:#@   ....:-+=-.        ...
                       .:+*##*+:..:--:       @@+...    ......:::......         ... ....::::.........-%  .=#*=-::-#%=.   ..=##:.
                               :#%=::#=.     @%:...                                                .-%@          .-%%+=*%*:.
                              .-%@%%#+.     @@+.....................................................-%             ..::..
                                 ..         @%:...:::...:::::::::.................::................-@@
                                  @@@@@    @@+..::....::.........:...............:....::::....::....=@       @@@@@@
                                @@*-:-=%@@ @@=..:....::....::....:.......*@@@#:..::.::...::....:....+@  @@@@@#+++++#@@
                               @@%:.....:%@@@=..::....:::::...:::.................:::::::....::.....#@@@@+:...   ...-@@
                               @@#.......-*%@+...:::.......::.....:#=...:#%:...-%-...:::::::.......-%@*-......   ...:%@@
                               @@@+.     ...#@*......::::..........*@*#%%%@%=:.+%:................:%@-...        ...*@@
                                @@@%-........+@%-....................-%#:..:=%@*:................:#%-....   ......=%@@
                                  @@@#-........+%@#-....         ....:%*.....*@=. . ..   ......-#@+......   ...:#@@
                                    @@@@#=:.......-*%@#*=::..........:%@=....*@-..........:-=#@#-..........:=#@@@
                                        @@@@#-.........:=*%%%%%***=---=#@@#*#@#--=***%%%@@%+=:..........-#@@@
                                            @@@%*:.      ......::----++++++++==---::::....         ....#@@
                                               @@#.         ............. ................         ....#@@
                                               @@%:                                                ....#@
                                                @@=.....                                           ....*@@
                                                @@#:....                                           ....+@@
                                                 @@%....                                           ....=@@
                                                 @@@=...                                           ....-@@@
                                                  @@@=..                                           .....*@@
                                                   @@@=......                                      .....:%@@@@@@
                                                    @@@+.....                                           ..:-:-==+*%%@@@@@@
                                                      @@%-...                                            ..............-*%@
                                                 @@@@@%#*-...                                               .......:-+#%@@
                                               @@#*=....... ........................................::---==**#%%@@@@@@
                                               @@*-.............:+#*%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                                                 @@@@@@%##%@@@@@@@@@@@        @@+...:@@@
                                                                             @@+.....%@
                                                                           @@#:...=-+@@
                                                                         @@#::+-.=@@@@
                                                                      @@@#++%@@+*@@@@
                                                                               @@
                                                                                                                                                        "
  echo "*****************************************************************"
  echo "                 DETEKT 검사를 통과했네요                            "
  echo "                    커밋을 해도 좋습니다                              "
  echo "*****************************************************************"
  echo -e "${RESET}"
  exit 0
fi
rm $OUTPUT
